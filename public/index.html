<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Banque Virtuelle</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">

  <h1>Banque Virtuelle</h1>

  <div class="card">
    <p>Solde disponible</p>
    <h2 id="balance">0 €</h2>
  </div>

  <!-- BOUTON AJOUTÉ -->
  <button onclick="location.href='/create.html'">
    Créer un lien de paiement
  </button>

  <div class="card">
    <h3>Envoyer de l'argent</h3>
    <input id="to" placeholder="Carte destinataire">
    <input id="amount" placeholder="Montant">
    <button onclick="send()">Envoyer</button>
  </div>

  <div class="card">
    <h3>Historique</h3>
    <ul id="history"></ul>
  </div>

</div>

<script>
fetch("/me")
.then(r=>r.json())
.then(d=>{
  balance.innerText = d.balance + " €";
  d.history.forEach(h=>{
    const li = document.createElement("li");
    li.innerText = h;
    history.appendChild(li);
  });
});

function send(){
  fetch("/send",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({
      to: to.value,
      amount: Number(amount.value)
    })
  }).then(()=>location.reload());
}
</script>

</body>
</html>
